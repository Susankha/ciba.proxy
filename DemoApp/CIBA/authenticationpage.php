<!DOCTYPE html>
<html lang="en">
<head>
<title>Pay Here</title>
 <!-- Meta-Tags -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8">
    <meta name="keywords" content="Business Login Form a Responsive Web Template, Bootstrap Web Templates, Flat Web Templates, Android Compatible Web Template, Smartphone Compatible Web Template, Free Webdesigns for Nokia, Samsung, LG, Sony Ericsson, Motorola Web Design">

	
    <!-- //Meta-Tags -->
	
	<!-- css files -->
	<link href="css/font1-awesome.min.css" rel="stylesheet" type="text/css" media="all">
	<link href="css/style1.css" rel="stylesheet" type="text/css" media="all"/>
	<link href="css/cibacss.css" rel="stylesheet" type="text/css" media="all"/>
	<link href="css/xcss.css" rel="stylesheet" type="text/css" media="all"/>
	 <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
  	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
 	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
  	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

	<link href="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
	<script src="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
	<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<!------ Include the above in your HEAD tag ---------->




	<!-- //css files -->
	
	<!-- google fonts -->
	<link href="//fonts.googleapis.com/css?family=Raleway:100,100i,200,200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet">
	<!-- //google fonts -->
	
</head>
<script>
function showHint() {


	console.log("Identity Received");
	var data = null;
        var xmlhttp = new XMLHttpRequest();
		
xmlhttp.open("POST", "http://localhost:8080/CIBAEndPoint?request=eyJraWQiOiJsdGFjZXNidyIsImFsZyI6IlJTMjU2In0.eyJpc3MiOiJz%0A%20%20%20NkJoZFJrcXQzIiwiYXVkIjoiaHR0cHM6Ly9zZXJ2ZXIuZXhhbXBsZS5jb20iLCJl%0A%20%20%20eHAiOjE1Mzc4MjAwODYsImlhdCI6MTUzNzgxOTQ4NiwibmJmIjoxNTM3ODE4ODg2%0A%20%20%20LCJqdGkiOiI0TFRDcUFDQzJFU0M1QldDbk4zajU4RW5BIiwic2NvcGUiOiJvcGVu%0A%20%20%20aWQgZW1haWwgZXhhbXBsZS1zY29wZSIsImNsaWVudF9ub3RpZmljYXRpb25fdG9r%0A%20%20%20ZW4iOiI4ZDY3ZGM3OC03ZmFhLTRkNDEtYWFiZC02NzcwN2IzNzQyNTUiLCJiaW5k%0A%20%20%20aW5nX21lc3NhZ2UiOiJXNFNDVCIsImxvZ2luX2hpbnRfdG9rZW4iOiJleUpyYVdR%0A%20%20%20aU9pSnNkR0ZqWlhOaWR5SXNJbUZzWnlJNklsSlRNalUySW4wLmV5SnpkV0pxWldO%0A%20%20%20MElqcDdJbk4xWW1wbFkzUmZkSGx3WlNJNkluQm9iMjVsSWl3aWNHaHZibVVpT2lJ%0A%20%20%20ck1UTXpNREk0TVRnd01EUWlmWDAuWUI4XzhPa3NKZDFGd2ZWc0lVbEgtcnM5Y1Bo%0A%20%20%20a0lhMERVaTdPVldfRGE5Z1A2aHVCeGY3YVNEbDNxS1hBMjB1VDF6VGh1U2lZejBi%0A%20%20%20ZHo4Sl9LUFJIdUM2dndvRmx6OXlCSjlrc1dPUDI4c0hQUGkxOV80LXhpZHduYjhQ%0A%20%20%20MTItUm9Yd1kyZUFGODJfTkFuMnZtcHZxVWpsdW9XeU5IYXk4dmd1Q2hJdXRxemlW%0A%20%20%20MGJGbC03b2F4cDM2aTRlbGJ2VF9EWWVnMjBhMGp6NHdJQktjXzQ2SzhJMjhFcmt3%0A%20%20%20Ykk1TzM1R2ZFbFBYbC00SjU1Tkhra09zRHh1VVlRdFdqU00zd21lMTk3MzVYV3Ey%0A%20%20%20RElUMm5tTEZpNEh6elQyN1cwY25KZzdMX2FpOXVOTkJ2SXhfTXA1QWJjbWtSODNh%0A%20%20%20cFI0anhuUXVFNVhmMjNxeVJwQWhhd2U3SVBRIn0.IBuxW3F_L9tj9f6fGC7FnVsH%0A%20%20%209B9RoJYA8QyxtnxgOgMc1kcnufyGxdtd7lU1TjPCVNsbkR0vfGasCmoMYSMohPOb%0A%20%20%20nwAlkm8Yf0uglhxM83B0dj_I10vwlMGnVFvydaH9wnacM4Ln7E-JIYOxtZa33abf%0A%20%20%201PB3fLs29GKOBmgNPn3NrxJ0iCLb0F243556Ypzdhcyj7vM8ukNzkKT3eQ0ZWJ1v%0A%20%20%20VRToThgKyIN-HvLFpeSfJtSH5ycMYOjob-qXUgKpQryUbgbpqsM1XnUV-8aBD5d8%0A%20%20%20VF5fQoz0PQWq63B_zpC22nstIFxNmfxztSFpnW0vgX0htNKOtL_HMwFRfwh71g");
	xmlhttp.setRequestHeader("Content-Type", "text/plain;charset=UTF-8");
    	xmlhttp.onreadystatechange = function() {
		
        if (this.readyState === 4 && this.status === 200) {
			console.log("Authentication Response Received")
			var response = this.responseText;
			var json = JSON.parse(response);
			var auth_req_id = json.auth_req_id;
			var interval = json.interval;


			console.log("Auth_req ID",auth_req_id)
			
			setTimeout(function(){tokenrequest(auth_req_id)}, interval*2000);

			 
		} else{
			console.log(this.responseText);
        }
};
console.log("Authentication Request Sent");
   
    xmlhttp.send(data);

};
    
	function tokenrequest(auth_req_id){
		console.log("Token Request posted")
		var data1=null
		var id= auth_req_id;
		var xmlhttp = new XMLHttpRequest();
		xmlhttp.open("POST", "http://localhost:8080/TokenEndPoint?auth_req_id="+id+"&grant_type=urn:openid:params:grant-type:ciba", true);
		xmlhttp.onreadystatechange = function() {
        		if (this.readyState == 4 && this.status == 200) {
			console.log(this.responseText)
			var response = this.responseText;
			var json = JSON.parse(response);
			var id_token = json.ID_token;

			
			console.log("Token received")
			window.open("resultpage.php");
			 
			}else{
			//window.open("ErrorPage.php);
			console.log(this.responseText);
			}	
 
        	};

    
    	xmlhttp.send(data1);
		
	};
    </script>
<body onload="showHint()">


<div class="space-medium">
        <div class="container">
            <div class="row">
                <div class="col-xl-5 col-lg-5 col-md-12 col-sm-12 col-12">
                    <div class="feature-block-v7 feature-block">
                        <div class="feature-icon text-brand bg-brand-light mb-5">
                            <i class="fas fa-paint-roller"></i>
                        </div>
                        <div class="feature-content">
                            <h2>Pay Here</h2>
                            <p class="lead">Please Authenticate.</p>
                            <hr class="m-t-30 m-b-30">
                            <p>Transaction ID : 19081995</p>
                            <p>Waiting for your Authentication.</p>
                            <div id="circle">
  <div class="loader">
    <div class="loader">
        <div class="loader">
           <div class="loader">

           </div>
        </div>
    </div>
  </div>
</div> 


                        </div>
                    </div>
                </div>
                <div class="offset-xl-1 col-xl-6 col-lg-6 col-md-12 col-sm-12 col-12">
                    <div class="circle-1"></div>
                    <div class="feature-app-img">
                        <img src="https://jituchauhan.com/quanto/quanto/images/iphone-img-2.png" alt="App Landing Page Template - Quanto">
                    </div>
                </div>
            </div>
             <div class="row">
                    <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 text-center mt-4"> 
              Created for <a href="https://jituchauhan.com/quanto/" target="_blank" class="text-primary">jituchauhan.com</a>
              </div></div>
        </div>
    </div>
</body>
</html>
